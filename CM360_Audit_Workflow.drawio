<mxfile host="app.diagrams.net" modified="2025-10-21T12:00:00.000Z" agent="Mozilla/5.0" version="21.0.0" etag="workflow-v1" type="device">
  <diagram name="CM360 Audit System" id="cm360-workflow">
    <mxGraphModel dx="1422" dy="794" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="2000" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        
        <!-- Title -->
        <mxCell id="title" value="CM360 Daily Audit System - Complete Workflow" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=24;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="400" y="20" width="800" height="40" as="geometry" />
        </mxCell>
        
        <!-- PHASE 1: Trigger & Initialization -->
        <mxCell id="phase1-box" value="PHASE 1: TRIGGER &amp; INITIALIZATION" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=14;fontStyle=1;verticalAlign=top;align=center;" vertex="1" parent="1">
          <mxGeometry x="40" y="80" width="360" height="180" as="geometry" />
        </mxCell>
        
        <mxCell id="trigger" value="Time-Based Trigger&#xa;(Daily 7:00 AM EST)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="60" y="120" width="140" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="batch-router" value="Batch Router&#xa;(2 configs per batch)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="240" y="120" width="140" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="preload" value="Preload Config Data&#xa;(Recipients, Thresholds, Exclusions)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="60" y="200" width="320" height="40" as="geometry" />
        </mxCell>
        
        <mxCell id="edge1" edge="1" parent="1" source="trigger" target="batch-router">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="edge2" edge="1" parent="1" source="batch-router" target="preload">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- PHASE 2: Gmail Fetching -->
        <mxCell id="phase2-box" value="PHASE 2: EMAIL REPORT RETRIEVAL" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=14;fontStyle=1;verticalAlign=top;align=center;" vertex="1" parent="1">
          <mxGeometry x="440" y="80" width="360" height="240" as="geometry" />
        </mxCell>
        
        <mxCell id="gmail-label" value="Find Gmail Label&#xa;(e.g., 'CM360/PST01')" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="460" y="120" width="140" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="filter-today" value="Filter Threads&#xa;(Today's date only)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="640" y="120" width="140" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="extract-attachments" value="Extract Excel Attachments&#xa;(from email threads)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="460" y="200" width="140" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="save-drive" value="Save to Drive&#xa;(Temp Daily Reports folder)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="640" y="200" width="140" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="temp-folder" value=" Temp_CM360_YYYYMMDD_HHMMSS" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontStyle=2" vertex="1" parent="1">
          <mxGeometry x="460" y="280" width="320" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="edge3" edge="1" parent="1" source="preload" target="gmail-label">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="edge4" edge="1" parent="1" source="gmail-label" target="filter-today">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="edge5" edge="1" parent="1" source="filter-today" target="extract-attachments">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="edge6" edge="1" parent="1" source="extract-attachments" target="save-drive">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="edge7" edge="1" parent="1" source="save-drive" target="temp-folder">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- PHASE 3: Merging & Validation -->
        <mxCell id="phase3-box" value="PHASE 3: EXCEL MERGING &amp; VALIDATION" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=14;fontStyle=1;verticalAlign=top;align=center;" vertex="1" parent="1">
          <mxGeometry x="840" y="80" width="360" height="320" as="geometry" />
        </mxCell>
        
        <mxCell id="convert-excel" value="Convert Excel  Sheets&#xa;(Drive API conversion)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="860" y="120" width="140" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="find-headers" value="Find Header Row&#xa;(keyword detection)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="1040" y="120" width="140" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="validate-order" value="Validate Column Order&#xa;(14-column spec)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="860" y="200" width="140" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="normalize-pixels" value="Normalize Pixel Sizes&#xa;('1 x 1'  '1x1')" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="1040" y="200" width="140" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="merge-sheets" value="Merge All Files&#xa;(append to master sheet)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="860" y="280" width="140" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="freeze-header" value="Freeze Header Row&#xa;&amp; Apply Formatting" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="1040" y="280" width="140" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="merged-output" value=" CM360_Merged_Audit_CONFIG_YYYY-MM-DD" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontStyle=2" vertex="1" parent="1">
          <mxGeometry x="860" y="360" width="320" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="edge8" edge="1" parent="1" source="temp-folder" target="convert-excel">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="edge9" edge="1" parent="1" source="convert-excel" target="find-headers">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="edge10" edge="1" parent="1" source="find-headers" target="validate-order">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="edge11" edge="1" parent="1" source="validate-order" target="normalize-pixels">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="edge12" edge="1" parent="1" source="normalize-pixels" target="merge-sheets">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="edge13" edge="1" parent="1" source="merge-sheets" target="freeze-header">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="edge14" edge="1" parent="1" source="freeze-header" target="merged-output">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- PHASE 4: Flagging Logic -->
        <mxCell id="phase4-box" value="PHASE 4: AUDIT FLAGGING ENGINE" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=14;fontStyle=1;verticalAlign=top;align=center;" vertex="1" parent="1">
          <mxGeometry x="40" y="440" width="760" height="340" as="geometry" />
        </mxCell>
        
        <mxCell id="row-iteration" value="Iterate Each Data Row" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=12;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="60" y="480" width="320" height="40" as="geometry" />
        </mxCell>
        
        <!-- Flag Type 1 -->
        <mxCell id="flag1-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="60" y="540" width="160" height="110" as="geometry" />
        </mxCell>
        
        <mxCell id="flag1-title" value="Clicks &gt; Impressions" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;fontStyle=1;fontSize=11" vertex="1" parent="1">
          <mxGeometry x="60" y="545" width="160" height="20" as="geometry" />
        </mxCell>
        
        <mxCell id="flag1-logic" value=" Check: clicks &gt; impressions&#xa; Threshold: dominant metric&#xa; Exclusion check" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;fontSize=9" vertex="1" parent="1">
          <mxGeometry x="70" y="570" width="140" height="70" as="geometry" />
        </mxCell>
        
        <!-- Flag Type 2 -->
        <mxCell id="flag2-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="240" y="540" width="160" height="110" as="geometry" />
        </mxCell>
        
        <mxCell id="flag2-title" value="Out of Flight Dates" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;fontStyle=1;fontSize=11" vertex="1" parent="1">
          <mxGeometry x="240" y="545" width="160" height="20" as="geometry" />
        </mxCell>
        
        <mxCell id="flag2-logic" value=" Check: start &gt; today OR end &lt; today&#xa; Threshold: dominant metric&#xa; Exclusion check" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;fontSize=9" vertex="1" parent="1">
          <mxGeometry x="250" y="570" width="140" height="70" as="geometry" />
        </mxCell>
        
        <!-- Flag Type 3 -->
        <mxCell id="flag3-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="420" y="540" width="160" height="110" as="geometry" />
        </mxCell>
        
        <mxCell id="flag3-title" value="Pixel Size Mismatch" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;fontStyle=1;fontSize=11" vertex="1" parent="1">
          <mxGeometry x="420" y="545" width="160" height="20" as="geometry" />
        </mxCell>
        
        <mxCell id="flag3-logic" value=" Check: placement size  creative size&#xa; Threshold: dominant metric&#xa; Exclusion check" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;fontSize=9" vertex="1" parent="1">
          <mxGeometry x="430" y="570" width="140" height="70" as="geometry" />
        </mxCell>
        
        <!-- Flag Type 4 -->
        <mxCell id="flag4-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="600" y="540" width="160" height="110" as="geometry" />
        </mxCell>
        
        <mxCell id="flag4-title" value="Default Ad Serving" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;fontStyle=1;fontSize=11" vertex="1" parent="1">
          <mxGeometry x="600" y="545" width="160" height="20" as="geometry" />
        </mxCell>
        
        <mxCell id="flag4-logic" value=" Check: ad type contains 'default'&#xa; Threshold: dominant metric&#xa; Exclusion check" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;fontSize=9" vertex="1" parent="1">
          <mxGeometry x="610" y="570" width="140" height="70" as="geometry" />
        </mxCell>
        
        <mxCell id="threshold-note" value="Thresholds: Use HIGHER of (clicks, impressions) to reduce low-volume noise" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontSize=10;fontStyle=2" vertex="1" parent="1">
          <mxGeometry x="60" y="670" width="700" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="flagged-rows" value="Collect Flagged Rows&#xa;(with flag reasons)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="60" y="720" width="320" height="40" as="geometry" />
        </mxCell>
        
        <mxCell id="edge15" edge="1" parent="1" source="row-iteration" target="flag1-box">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="edge16" edge="1" parent="1" source="flag4-box" target="flagged-rows">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- PHASE 5: Email Decision -->
        <mxCell id="phase5-box" value="PHASE 5: EMAIL DELIVERY LOGIC" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=14;fontStyle=1;verticalAlign=top;align=center;" vertex="1" parent="1">
          <mxGeometry x="840" y="440" width="360" height="340" as="geometry" />
        </mxCell>
        
        <mxCell id="check-flags" value="Flags Found?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="920" y="480" width="120" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="build-email-flagged" value="Build Flagged Email&#xa; HTML table&#xa; Excel attachment&#xa; Summary counts" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="860" y="600" width="140" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="build-email-clean" value="Build Clean Email&#xa; No issues message&#xa; Optional attachment" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="1040" y="600" width="140" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="staging-check" value="Staging Mode?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="920" y="710" width="120" height="50" as="geometry" />
        </mxCell>
        
        <mxCell id="send-admin" value="Send to ADMIN_EMAIL" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="860" y="720" width="140" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="send-recipients" value="Send to Recipients&#xa;(from config sheet)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="1060" y="720" width="120" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="edge17" edge="1" parent="1" source="flagged-rows" target="check-flags">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="edge18" value="YES" edge="1" parent="1" source="check-flags" target="build-email-flagged">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="edge19" value="NO" edge="1" parent="1" source="check-flags" target="build-email-clean">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="edge20" edge="1" parent="1" source="build-email-flagged" target="staging-check">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="edge21" edge="1" parent="1" source="build-email-clean" target="staging-check">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="edge22" value="YES" edge="1" parent="1" source="staging-check" target="send-admin">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="edge23" value="NO" edge="1" parent="1" source="staging-check" target="send-recipients">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- PHASE 6: Summary & Cleanup -->
        <mxCell id="phase6-box" value="PHASE 6: BATCH COMPLETION &amp; SUMMARY" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=14;fontStyle=1;verticalAlign=top;align=center;" vertex="1" parent="1">
          <mxGeometry x="40" y="820" width="760" height="200" as="geometry" />
        </mxCell>
        
        <mxCell id="store-results" value="Store Audit Results&#xa;(CacheService)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="60" y="860" width="160" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="check-complete" value="All Configs Complete?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="260" y="860" width="140" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="send-summary" value="Send Daily Summary Email&#xa; Aggregate statistics&#xa; Delta from yesterday&#xa; Top offenders&#xa; Links to reports" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="440" y="860" width="180" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="move-files" value="Move Source Files&#xa;(to Trash/60-day cleanup)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="60" y="950" width="160" height="50" as="geometry" />
        </mxCell>
        
        <mxCell id="cleanup-trigger" value="Nightly Cleanup&#xa;(Delete files &gt; 60 days)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontStyle=2" vertex="1" parent="1">
          <mxGeometry x="260" y="950" width="160" height="50" as="geometry" />
        </mxCell>
        
        <mxCell id="edge24" edge="1" parent="1" source="send-admin" target="store-results">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="edge25" edge="1" parent="1" source="send-recipients" target="store-results">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="edge26" edge="1" parent="1" source="store-results" target="check-complete">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="edge27" value="YES" edge="1" parent="1" source="check-complete" target="send-summary">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="edge28" edge="1" parent="1" source="check-complete" target="move-files">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <!-- Configuration Sources -->
        <mxCell id="config-box" value="CONFIGURATION SOURCES" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontSize=14;fontStyle=1;verticalAlign=top;align=center;" vertex="1" parent="1">
          <mxGeometry x="840" y="820" width="360" height="200" as="geometry" />
        </mxCell>
        
        <mxCell id="config-recipients" value=" Audit Recipients Sheet&#xa;(TO, CC per config)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="860" y="860" width="160" height="40" as="geometry" />
        </mxCell>
        
        <mxCell id="config-thresholds" value=" Audit Thresholds Sheet&#xa;(min impressions/clicks per flag)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="1040" y="860" width="140" height="40" as="geometry" />
        </mxCell>
        
        <mxCell id="config-exclusions" value=" Audit Exclusions Sheet&#xa;(placement ID exceptions)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="860" y="920" width="160" height="40" as="geometry" />
        </mxCell>
        
        <mxCell id="config-external" value=" External Config Spreadsheet&#xa;(shared with non-technical users)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="1040" y="920" width="140" height="40" as="geometry" />
        </mxCell>
        
        <mxCell id="config-sync" value=" Bi-directional Sync&#xa;(nightly automation)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontStyle=2" vertex="1" parent="1">
          <mxGeometry x="860" y="980" width="320" height="30" as="geometry" />
        </mxCell>
        
        <!-- Supporting Systems -->
        <mxCell id="support-box" value="SUPPORTING SYSTEMS" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontSize=14;fontStyle=1;verticalAlign=top;align=center;" vertex="1" parent="1">
          <mxGeometry x="40" y="1060" width="1160" height="180" as="geometry" />
        </mxCell>
        
        <mxCell id="watchdog" value=" Watchdog Trigger&#xa;(detects hung batches)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="60" y="1100" width="140" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="health-check" value=" Health Check&#xa;(pre-flight validation)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="220" y="1100" width="140" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="quota-tracker" value=" Email Quota Tracker&#xa;(prevents overages)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="380" y="1100" width="140" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="delivery-mode" value=" Delivery Mode Sync&#xa;(STAGING  PRODUCTION)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="540" y="1100" width="140" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="error-forward" value=" GAS Error Forwarder&#xa;(auto-alerts admin)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="700" y="1100" width="140" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="batch-rebalance" value=" Batch Rebalancer&#xa;(optimize runtime)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="860" y="1100" width="140" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="placement-lookup" value=" Placement Name Lookup&#xa;(auto-populate exclusions)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="1020" y="1100" width="160" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="testing-tools" value=" Testing Tools: Silent Withhold Check, Threshold Diagnostics, Batch Test" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontStyle=2" vertex="1" parent="1">
          <mxGeometry x="60" y="1190" width="1120" height="30" as="geometry" />
        </mxCell>
        
        <!-- Legend -->
        <mxCell id="legend-box" value="LEGEND" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontSize=12;fontStyle=1;verticalAlign=top;align=center;" vertex="1" parent="1">
          <mxGeometry x="40" y="1280" width="400" height="140" as="geometry" />
        </mxCell>
        
        <mxCell id="legend1" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="60" y="1310" width="30" height="20" as="geometry" />
        </mxCell>
        <mxCell id="legend1-text" value="Data Processing" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="100" y="1310" width="120" height="20" as="geometry" />
        </mxCell>
        
        <mxCell id="legend2" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="240" y="1310" width="30" height="20" as="geometry" />
        </mxCell>
        <mxCell id="legend2-text" value="Success/Clean Path" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="280" y="1310" width="140" height="20" as="geometry" />
        </mxCell>
        
        <mxCell id="legend3" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="60" y="1340" width="30" height="20" as="geometry" />
        </mxCell>
        <mxCell id="legend3-text" value="Alert/Issue Path" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="100" y="1340" width="120" height="20" as="geometry" />
        </mxCell>
        
        <mxCell id="legend4" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="240" y="1340" width="30" height="20" as="geometry" />
        </mxCell>
        <mxCell id="legend4-text" value="Logic/Decision" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="280" y="1340" width="140" height="20" as="geometry" />
        </mxCell>
        
        <mxCell id="legend5" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="60" y="1370" width="30" height="20" as="geometry" />
        </mxCell>
        <mxCell id="legend5-text" value="Output/Storage" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="100" y="1370" width="120" height="20" as="geometry" />
        </mxCell>
        
        <mxCell id="legend6" value="" style="rhombus;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="240" y="1365" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="legend6-text" value="Decision Point" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="280" y="1370" width="140" height="20" as="geometry" />
        </mxCell>
        
        <!-- Stats Box -->
        <mxCell id="stats-box" value="SYSTEM STATISTICS" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=12;fontStyle=1;verticalAlign=top;align=center;" vertex="1" parent="1">
          <mxGeometry x="480" y="1280" width="720" height="140" as="geometry" />
        </mxCell>
        
        <mxCell id="stats-content" value=" 20+ Client Configurations (multi-tenant)&#xa; 2 Configs per Batch (optimized for 6-min runtime limit)&#xa; 4 Flag Types (clicks&gt;impressions, out-of-flight, pixel-mismatch, default-ad)&#xa; 60-Day Retention (automatic cleanup)&#xa; Dominant Metric Thresholds (smart volume filtering)&#xa; Bi-directional Config Sync (external sheet  admin sheet)&#xa; Daily Summary Email (aggregate stats with deltas)&#xa; Staging Mode (safe testing before production)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;fontSize=10" vertex="1" parent="1">
          <mxGeometry x="500" y="1310" width="680" height="100" as="geometry" />
        </mxCell>
        
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
